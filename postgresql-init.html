<html>
<head>
  <title>PostgreSQL 初始配置</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/309091 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1513"/>
<h1>PostgreSQL 初始配置</h1>

<div>
<span><div><span style="font-style: italic;">Ubuntu 64位 1</span></div><div><br/></div><div>通过预编译包安装会自动创建 postgres 用户和 postgres 库。</div><div><br/></div><div><span style="font-weight: bold;">进程信息：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@vm-ubuntu-1:~# ps -ef|grep post</div><div>postgres    1099       1  0 10:17 ?        00:00:00 /usr/lib/postgresql/14/bin/postgres -D /var/lib/postgresql/14/main -c config_file=/etc/postgresql/14/main/postgresql.conf</div><div>postgres    1143    1099  0 10:17 ?        00:00:00 postgres: 14/main: checkpointer</div><div>postgres    1144    1099  0 10:17 ?        00:00:00 postgres: 14/main: background writer</div><div>postgres    1145    1099  0 10:17 ?        00:00:00 postgres: 14/main: walwriter</div><div>postgres    1146    1099  0 10:17 ?        00:00:00 postgres: 14/main: autovacuum launcher</div><div>postgres    1147    1099  0 10:17 ?        00:00:00 postgres: 14/main: stats collector</div><div>postgres    1148    1099  0 10:17 ?        00:00:00 postgres: 14/main: logical replication launcher</div></div><div><br/></div><div><span style="font-weight: bold;">文件目录：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>postgres@vm-ubuntu-1:~/14/main$ pwd</div><div>/var/lib/postgresql/14/main</div><div>postgres@vm-ubuntu-1:~/14/main$ ls -l</div><div>total 84</div><div>drwx------ 5 postgres postgres 4096 Jun 10 23:28 base</div><div>drwx------ 2 postgres postgres 4096 Jun 11 10:46 global</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_commit_ts</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_dynshmem</div><div>drwx------ 4 postgres postgres 4096 Jun 11 10:22 pg_logical</div><div>drwx------ 4 postgres postgres 4096 Jun 10 23:28 pg_multixact</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_notify</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_replslot</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_serial</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_snapshots</div><div>drwx------ 2 postgres postgres 4096 Jun 11 10:17 pg_stat</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_stat_tmp</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_subtrans</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_tblspc</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_twophase</div><div>-rw------- 1 postgres postgres    3 Jun 10 23:28 PG_VERSION</div><div>drwx------ 3 postgres postgres 4096 Jun 10 23:28 pg_wal</div><div>drwx------ 2 postgres postgres 4096 Jun 10 23:28 pg_xact</div><div>-rw------- 1 postgres postgres   88 Jun 10 23:28 postgresql.auto.conf</div><div>-rw------- 1 postgres postgres  130 Jun 11 10:17 postmaster.opts</div><div>-rw------- 1 postgres postgres  108 Jun 11 10:17 postmaster.pid</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>postgres@vm-ubuntu-1:/etc/postgresql/14/main$ pwd</div><div>/etc/postgresql/14/main</div><div>postgres@vm-ubuntu-1:/etc/postgresql/14/main$ ls -l</div><div>total 60</div><div>drwxr-xr-x 2 postgres postgres  4096 Jun 10 23:28 conf.d</div><div>-rw-r--r-- 1 postgres postgres   315 Jun 10 23:28 environment</div><div>-rw-r--r-- 1 postgres postgres   143 Jun 10 23:28 pg_ctl.conf</div><div>-rw-r----- 1 postgres postgres  5002 Jun 10 23:28 pg_hba.conf</div><div>-rw-r----- 1 postgres postgres  1636 Jun 10 23:28 pg_ident.conf</div><div>-rw-r--r-- 1 postgres postgres 29060 Jun 10 23:28 postgresql.conf</div><div>-rw-r--r-- 1 postgres postgres   317 Jun 10 23:28 start.conf</div></div><div><br/></div><div><span style="font-weight: bold;">系统服务：</span></div><div style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px;"><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">sudo</span> <span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">etc</span><span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">init</span><span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">.</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">d</span><span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">postgresql start</span></div><div style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px;"><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">sudo</span> <span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">etc</span><span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">init</span><span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">.</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">d</span><span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">postgresql stop</span></div><div style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px;"><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">sudo</span> <span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">etc</span><span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">init</span><span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">.</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">d</span><span style="border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-size: 12px; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">postgresql restart</span></div><div style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px;"><span style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px; border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">sudo</span> <span style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px; border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px; border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">etc</span><span style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px; border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px; border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">init</span><span style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px; border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">.</span><span style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px; border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">d</span><span style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px; border: 0px; color: rgb(102, 102, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">/</span><span style="background-color: rgb(251, 251, 251); font-size: 12px; letter-spacing: normal; orphans: 2; white-space: pre-wrap; widows: 2; word-spacing: 0px; border: 0px; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace; font-stretch: normal; font-style: normal; font-variant: normal; font-weight: 400; line-height: 20px;">postgresql status</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@vm-ubuntu-1:~# systemctl status postgresql</div><div>● postgresql.service - PostgreSQL RDBMS</div><div>     Loaded: loaded (/lib/systemd/system/postgresql.service; enabled; vendor preset: enabled)</div><div>     Active: active (exited) since Sat 2022-06-11 10:17:14 CST; 23min ago</div><div>    Process: 1210 ExecStart=/bin/true (code=exited, status=0/SUCCESS)</div><div>   Main PID: 1210 (code=exited, status=0/SUCCESS)</div><div><br/></div><div><br/></div><div>Jun 11 10:17:14 vm-ubuntu-1 systemd[1]: Starting PostgreSQL RDBMS...</div><div>Jun 11 10:17:14 vm-ubuntu-1 systemd[1]: Finished PostgreSQL RDBMS.</div></div><div><br/></div><div><span style="font-weight: bold;">psql命令：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@vm-ubuntu-1:~# su - postgres</div><div>postgres@vm-ubuntu-1:~$ psql <font color="#A8A8A8">[postgres 如果你不提供数据库名字，那么它的缺省值就是你的用户账号名字。]</font></div><div>psql (14.3 (Ubuntu 14.3-1.pgdg20.04+1))</div><div>Type &quot;help&quot; for help.</div><div><br/></div><div><br/></div><div>postgres=# \q <i><font color="#A8A8A8">退出</font></i></div><div>postgres@vm-ubuntu-1:~$</div></div><div><br/></div><div><span style="font-weight: bold;">远程客户端连接：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>alter user postgres with password '你要设置的密码';</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/etc/postgresql/14/main/postgresql.conf</div><div>listen_addresses = '*'<br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>/etc/postgresql/14/main/pg_hba.conf</div><div>host    all             all             127.0.0.1/32            scram-sha-256</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">改成</span></div><div>host    all             all             all                     scram-sha-256</div></div><div><br/></div></span>
</div></body></html> 